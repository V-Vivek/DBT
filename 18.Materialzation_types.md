# DBT Materialization Types

DBT supports several materialization types that define how models are built and stored in your data warehouse. The main types are: **Ephemeral**, **View**, **Table**, and **Incremental**.

---

## 1. Ephemeral

- **Description:** Ephemeral models are not persisted in the database. Instead, their SQL is inlined into dependent models as Common Table Expressions (CTEs).
- **Use Case:** Use for lightweight transformations or logic reused in multiple models, where you don't need to store intermediate results.
- **Example:**
    ```sql
    -- models/ephemeral_model.sql
    {{ config(materialized='ephemeral') }}
    select id, upper(name) as name_upper from raw_users
    ```
- **Scenario:** Use when you want to avoid creating unnecessary tables/views and optimize query performance.

---

## 2. View

- **Description:** DBT creates a view in the database. The SQL logic is run every time the view is queried.
- **Use Case:** Use when data changes frequently or when storage is a concern, and you want always up-to-date results.
- **Example:**
    ```sql
    -- models/user_view.sql
    {{ config(materialized='view') }}
    select * from raw_users
    ```
- **Scenario:** Use for lightweight transformations or when underlying data updates often.

---

## 3. Table

- **Description:** DBT creates a physical table. Data is materialized (copied) into the table at build time.
- **Use Case:** Use for expensive transformations or when you want to snapshot data at a point in time.
- **Example:**
    ```sql
    -- models/user_table.sql
    {{ config(materialized='table') }}
    select * from raw_users
    ```
- **Scenario:** Use when queries are slow or when you need stable, point-in-time data.

---

## 4. Incremental

- **Description:** DBT builds a table and only processes new or changed data on subsequent runs.
- **Use Case:** Use for large datasets where reprocessing all data is inefficient.
- **Example:**
    ```sql
    -- models/user_incremental.sql
    {{ config(materialized='incremental') }}
    select * from raw_users
    -- This check ensures only new or updated records are processed
    where
    {% if is_incremental() %}
        -- {{ this }} keyword refers to the current model i.e itself
        where updated_at > (select max(updated_at) from {{ this }})
    {% endif %}
    ```
- **Scenario:** Use for large, append-only or slowly changing tables to improve build performance.

---

## Summary Table

| Materialization | Storage   | Performance | Use When...                                 |
|-----------------|-----------|-------------|---------------------------------------------|
| Ephemeral       | None      | Fast        | Reusable logic, no need to persist results  |
| View            | View      | Medium      | Data changes often, storage is a concern    |
| Table           | Table     | Fast reads  | Expensive queries, need stable data         |
| Incremental     | Table     | Efficient   | Large datasets, only new data needs update  |
